{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Prajanya/SmartParking/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies()\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,   // â† USE SERVICE ROLE KEY HERE\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll()\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) =>\r\n              cookieStore.set(name, value, options)\r\n            )\r\n          } catch {\r\n            // Ignore for server components\r\n          }\r\n        },\r\n      },\r\n    }\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,gFAEvB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,+BAA+B;gBACjC;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Prajanya/SmartParking/app/api/sensors/webhook/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { createClient } from \"@/lib/supabase/server\"\r\n\r\ninterface SensorDistances {\r\n  center_distance: number\r\n  left_distance: number\r\n  right_distance: number\r\n  timestamp?: number\r\n}\r\n\r\ninterface ParkingAnalysis {\r\n  status: \"occupied\" | \"empty\" | \"entering\" | \"exiting\"\r\n  alignment: \"centered\" | \"left_biased\" | \"right_biased\" | \"severely_misaligned\"\r\n  quality_score: number\r\n  is_misparked: boolean\r\n  warnings: string[]\r\n  metrics: {\r\n    center_offset_cm: number\r\n    angle_deviation_deg: number\r\n    space_utilization: number\r\n  }\r\n}\r\n\r\nfunction analyzeParkingQuality(distances: SensorDistances): ParkingAnalysis {\r\n  const { center_distance, left_distance, right_distance } = distances;\r\n\r\n  const warnings: string[] = [];\r\n\r\n  // ===== STATUS LOGIC =====\r\n  // Only center sensor determines empty/occupied\r\n  const status: ParkingAnalysis[\"status\"] =\r\n    center_distance <= 80 ? \"occupied\" : \"empty\";\r\n\r\n  // ===== ALIGNMENT LOGIC =====\r\n  const alignmentDiff = Math.abs(left_distance - right_distance);\r\n  const alignmentThreshold = 15; // Default threshold\r\n  const severeMisalignThreshold = 80; // Updated severe threshold\r\n\r\n  let alignment: ParkingAnalysis[\"alignment\"];\r\n\r\n  if (alignmentDiff <= alignmentThreshold) {\r\n    alignment = \"centered\";\r\n  } else if (alignmentDiff <= alignmentThreshold * 2) {\r\n    alignment =\r\n      left_distance < right_distance ? \"left_biased\" : \"right_biased\";\r\n    warnings.push(\r\n      `Vehicle is ${alignment.replace(\"_\", \" \")} by ${alignmentDiff.toFixed(1)}cm`\r\n    );\r\n  } else if (alignmentDiff < severeMisalignThreshold) {\r\n    // Still biased but not severe\r\n    alignment =\r\n      left_distance < right_distance ? \"left_biased\" : \"right_biased\";\r\n    warnings.push(\r\n      `Vehicle is ${alignment.replace(\"_\", \" \")} by ${alignmentDiff.toFixed(1)}cm`\r\n    );\r\n  } else {\r\n    alignment = \"severely_misaligned\";\r\n    warnings.push(\r\n      `Severe misalignment detected: ${alignmentDiff.toFixed(1)}cm difference`\r\n    );\r\n  }\r\n\r\n  // ===== MISPARKED LOGIC =====\r\n  const is_misparked = alignment === \"severely_misaligned\";\r\n\r\n  // ===== MINIMAL METRICS RETURNED =====\r\n  return {\r\n    status,\r\n    alignment,\r\n    is_misparked,\r\n    quality_score: is_misparked ? 0 : 100, // keep field for compatibility\r\n    warnings,\r\n    metrics: {\r\n      center_offset_cm: center_distance, // simply return raw values\r\n      angle_deviation_deg: 0,            // ignored\r\n      space_utilization: 0               // ignored\r\n    },\r\n  };\r\n}\r\n\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json()\r\n    const { sensor_id, api_key, spot_number, center_distance, left_distance, right_distance, timestamp } = body\r\n\r\n    console.log(\"[v0] Sensor webhook received:\", {\r\n      sensor_id,\r\n      spot_number,\r\n      distances: { center_distance, left_distance, right_distance },\r\n    })\r\n\r\n    if (\r\n      !sensor_id ||\r\n      !api_key ||\r\n      !spot_number ||\r\n      center_distance === undefined ||\r\n      left_distance === undefined ||\r\n      right_distance === undefined\r\n    ) {\r\n      return NextResponse.json(\r\n        {\r\n          error:\r\n            \"Missing required fields: sensor_id, api_key, spot_number, center_distance, left_distance, right_distance\",\r\n        },\r\n        { status: 400 },\r\n      )\r\n    }\r\n\r\n    const supabase = await createClient()\r\n\r\n    // Verify sensor credentials\r\n    const { data: sensorConfig, error: sensorError } = await supabase\r\n      .from(\"sensor_configs\")\r\n      .select(\"*, parking_lots(*)\")\r\n      .eq(\"sensor_id\", sensor_id)\r\n      .eq(\"api_key\", api_key)\r\n      .eq(\"status\", \"active\")\r\n      .single()\r\n\r\n    if (sensorError || !sensorConfig) {\r\n      console.error(\"[v0] Invalid sensor credentials:\", sensorError)\r\n      return NextResponse.json({ error: \"Invalid sensor credentials\" }, { status: 401 })\r\n    }\r\n\r\n    // Update sensor heartbeat\r\n    await supabase\r\n      .from(\"sensor_configs\")\r\n      .update({\r\n        last_heartbeat: new Date().toISOString(),\r\n      })\r\n      .eq(\"id\", sensorConfig.id)\r\n\r\n    const lotId = sensorConfig.lot_id\r\n\r\n    // Analyze parking quality\r\n    const analysis = analyzeParkingQuality({\r\n      center_distance,\r\n      left_distance,\r\n      right_distance,\r\n      timestamp,\r\n    })\r\n\r\n    // Find active booking for this spot\r\n    const now = new Date().toISOString()\r\n    const { data: activeBooking } = await supabase\r\n      .from(\"bookings\")\r\n      .select(\"*\")\r\n      .eq(\"lot_id\", lotId)\r\n      .eq(\"spot_number\", spot_number)\r\n      .eq(\"status\", \"active\")\r\n      .lte(\"start_date\", now)\r\n      .gte(\"end_date\", now)\r\n      .single()\r\n\r\n    // Determine event type based on status transition\r\n    let event_type = \"sensor_update\"\r\n    if (analysis.status === \"entering\") event_type = \"entry\"\r\n    if (analysis.status === \"exiting\") event_type = \"exit\"\r\n    if (analysis.is_misparked && analysis.status === \"occupied\") event_type = \"misparked\"\r\n\r\n    // Create parking event with full analysis\r\n    const { data: event, error: eventError } = await supabase\r\n      .from(\"parking_events\")\r\n      .insert({\r\n        lot_id: lotId,\r\n        booking_id: activeBooking?.id || null,\r\n        spot_number,\r\n        event_type,\r\n        sensor_data: {\r\n          raw_distances: { center_distance, left_distance, right_distance },\r\n          analysis,\r\n          timestamp: timestamp || Date.now(),\r\n        },\r\n      })\r\n      .select()\r\n      .single()\r\n\r\n    if (eventError) {\r\n      console.error(\"[v0] Error creating parking event:\", eventError)\r\n      return NextResponse.json({ error: \"Failed to create parking event\" }, { status: 500 })\r\n    }\r\n\r\n    // Handle misparking\r\n    if (analysis.is_misparked && activeBooking) {\r\n      // Update booking parking status\r\n      await supabase\r\n        .from(\"bookings\")\r\n        .update({\r\n          parking_status: \"misparked\",\r\n        })\r\n        .eq(\"id\", activeBooking.id)\r\n\r\n      // Check if penalty already exists for this booking\r\n      const { data: existingPenalty } = await supabase\r\n        .from(\"penalties\")\r\n        .select(\"*\")\r\n        .eq(\"booking_id\", activeBooking.id)\r\n        .eq(\"penalty_type\", \"misparking\")\r\n        .eq(\"status\", \"pending\")\r\n        .single()\r\n\r\n      if (!existingPenalty) {\r\n        const penaltyAmount = 50.0\r\n        const { data: penalty } = await supabase\r\n          .from(\"penalties\")\r\n          .insert({\r\n            booking_id: activeBooking.id,\r\n            lot_id: lotId,\r\n            user_id: activeBooking.user_id,\r\n            penalty_type: \"misparking\",\r\n            amount: penaltyAmount,\r\n            reason: `Parking quality score: ${analysis.quality_score}/100. ${analysis.warnings.join(\". \")}`,\r\n            status: \"pending\",\r\n          })\r\n          .select()\r\n          .single()\r\n\r\n        // Send notifications\r\n        await Promise.all([\r\n          sendPushNotification(activeBooking.user_id, {\r\n            title: \"Misparking Detected!\",\r\n            body: `Quality score: ${analysis.quality_score}/100. Please reposition your vehicle. Penalty: $${penaltyAmount}`,\r\n            data: { type: \"misparking\", bookingId: activeBooking.id, penaltyId: penalty?.id },\r\n          }),\r\n          sendPushNotification(sensorConfig.parking_lots.user_id, {\r\n            title: \"Misparking Alert\",\r\n            body: `Vehicle misparked at ${sensorConfig.parking_lots.name}, Spot ${spot_number}. Quality: ${analysis.quality_score}/100`,\r\n            data: { type: \"misparking_owner\", bookingId: activeBooking.id, lotId },\r\n          }),\r\n        ])\r\n      }\r\n    } else if (!analysis.is_misparked && activeBooking?.parking_status === \"misparked\") {\r\n      // Car was repositioned correctly\r\n      await supabase\r\n        .from(\"bookings\")\r\n        .update({\r\n          parking_status: \"normal\",\r\n        })\r\n        .eq(\"id\", activeBooking.id)\r\n\r\n      await sendPushNotification(activeBooking.user_id, {\r\n        title: \"Parking Corrected\",\r\n        body: `Thank you for repositioning your vehicle. Quality score: ${analysis.quality_score}/100`,\r\n        data: { type: \"parking_corrected\", bookingId: activeBooking.id },\r\n      })\r\n    }\r\n\r\n    // Handle entry\r\n    if (event_type === \"entry\" && activeBooking) {\r\n      if (activeBooking.status === \"upcoming\") {\r\n        await supabase.from(\"bookings\").update({ status: \"active\" }).eq(\"id\", activeBooking.id)\r\n      }\r\n\r\n      await sendPushNotification(sensorConfig.parking_lots.user_id, {\r\n        title: \"Vehicle Entry\",\r\n        body: `Vehicle entered ${sensorConfig.parking_lots.name}, Spot ${spot_number}`,\r\n        data: { type: \"entry\", bookingId: activeBooking.id, lotId },\r\n      })\r\n    }\r\n\r\n    // Handle exit\r\n    if (event_type === \"exit\" && activeBooking) {\r\n      await supabase.from(\"bookings\").update({ status: \"completed\" }).eq(\"id\", activeBooking.id)\r\n\r\n      await supabase\r\n        .from(\"parking_lots\")\r\n        .update({\r\n          available_spots: supabase.raw(\"available_spots + 1\"),\r\n        })\r\n        .eq(\"id\", lotId)\r\n\r\n      await Promise.all([\r\n        sendPushNotification(activeBooking.user_id, {\r\n          title: \"Parking Session Completed\",\r\n          body: `Thank you for using ${sensorConfig.parking_lots.name}`,\r\n          data: { type: \"exit\", bookingId: activeBooking.id },\r\n        }),\r\n        sendPushNotification(sensorConfig.parking_lots.user_id, {\r\n          title: \"Vehicle Exit\",\r\n          body: `Vehicle exited ${sensorConfig.parking_lots.name}, Spot ${spot_number}`,\r\n          data: { type: \"exit_owner\", bookingId: activeBooking.id, lotId },\r\n        }),\r\n      ])\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      event,\r\n      analysis,\r\n      message: analysis.warnings.length > 0 ? analysis.warnings.join(\". \") : \"Parking data recorded successfully\",\r\n    })\r\n  } catch (error) {\r\n    console.error(\"[v0] Sensor webhook error:\", error)\r\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 })\r\n  }\r\n}\r\n\r\n// Helper function to send push notifications\r\nasync function sendPushNotification(\r\n  userId: string,\r\n  payload: {\r\n    title: string\r\n    body: string\r\n    data?: any\r\n  },\r\n) {\r\n  try {\r\n    const supabase = await createClient()\r\n\r\n    // Get user's push subscriptions\r\n    const { data: subscriptions } = await supabase.from(\"push_subscriptions\").select(\"*\").eq(\"user_id\", userId)\r\n\r\n    if (!subscriptions || subscriptions.length === 0) {\r\n      console.log(\"[v0] No push subscriptions found for user:\", userId)\r\n      return\r\n    }\r\n\r\n    // Note: In production, you would use web-push library here\r\n    // For now, this is a placeholder that logs the notification\r\n    console.log(\"[v0] Would send push notification to user:\", userId, payload)\r\n\r\n    // TODO: Implement actual web push using web-push library\r\n    // const webpush = require('web-push')\r\n    // for (const subscription of subscriptions) {\r\n    //   await webpush.sendNotification(\r\n    //     {\r\n    //       endpoint: subscription.endpoint,\r\n    //       keys: {\r\n    //         p256dh: subscription.p256dh,\r\n    //         auth: subscription.auth\r\n    //       }\r\n    //     },\r\n    //     JSON.stringify(payload)\r\n    //   )\r\n    // }\r\n  } catch (error) {\r\n    console.error(\"[v0] Error sending push notification:\", error)\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}